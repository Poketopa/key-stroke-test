# 타이핑 패턴 전달 방식 분석

## 📋 개요

사용자가 제공한 타이핑 패턴의 구조와 TypingDNA API로의 전달 방식을 상세히 분석합니다.

## 🔍 제공된 타이핑 패턴

### 원본 데이터
```json
{
  "user_id": "testuser123",
  "text": "gemini",
  "tp": "0,3.2,0,1,6,3255507267,0,-1,-1,0,-1,-1,0,-1,-1,11,115,112,11,29,26,1,0,0,1,2,1,4210384742,1,1,0,0,0,1,2560,1440,2,1015,138,0,2343085426|103,6167,84,71|101,48,82,69|109,100,105,77|105,110,69,73|110,83,92,78|105,79,86,73"
}
```

### 패턴 구조 분석

#### 1. 기본 정보
- **텍스트**: "gemini" (6자)
- **패턴 길이**: 218자
- **패턴 타입**: Type 2 (Extended) - 권장 타입

#### 2. 패턴 구성 요소

##### A. 메타데이터 섹션 (파이프 | 이전)
```
0,3.2,0,1,6,3255507267,0,-1,-1,0,-1,-1,0,-1,-1,11,115,112,11,29,26,1,0,0,1,2,1,4210384742,1,1,0,0,0,1,2560,1440,2,1015,138,0,2343085426
```

**구성 요소:**
- `0` - 패턴 타입 (0: Any text, 1: Same text, 2: Extended)
- `3.2` - 평균 타이핑 속도 (초)
- `0,1,6` - 기본 설정값들
- `3255507267` - 타임스탬프
- `2560,1440` - 화면 해상도 (width x height)
- `1015,138` - 마우스 위치 (x, y)
- `2343085426` - 추가 타임스탬프

##### B. 키보드 이벤트 섹션 (파이프 | 이후)
```
103,6167,84,71|101,48,82,69|109,100,105,77|105,110,69,73|110,83,92,78|105,79,86,73
```

**각 그룹의 의미:**
- `103,6167,84,71` - 'g' 키 이벤트
- `101,48,82,69` - 'e' 키 이벤트  
- `109,100,105,77` - 'm' 키 이벤트
- `105,110,69,73` - 'i' 키 이벤트
- `110,83,92,78` - 'n' 키 이벤트
- `105,79,86,73` - 'i' 키 이벤트

**각 그룹의 구조:**
- 첫 번째 숫자: 키 코드 (ASCII 값)
- 두 번째 숫자: 키 다운 시간 (밀리초)
- 세 번째 숫자: 키 업 시간 (밀리초)
- 네 번째 숫자: 다음 키까지의 간격 (밀리초)

## 📡 API 전달 방식

### 1. HTTP 요청 구조

#### 요청 URL
```
POST https://api.typingdna.com/auto/testuser123
```

#### 요청 헤더
```http
Authorization: Basic M2EwN2Y0ZGFlODQ4NGZiN2Y3MGQwZDA2MTNhM2EzZTQ6ZDk3YWUxMTBhODg0YzE5ZjQ3MzE4ZDU0MzczZTI3ZDk=
Content-Type: application/x-www-form-urlencoded
```

#### 요청 본문
```
tp=0,3.2,0,1,6,3255507267,0,-1,-1,0,-1,-1,0,-1,-1,11,115,112,11,29,26,1,0,0,1,2,1,4210384742,1,1,0,0,0,1,2560,1440,2,1015,138,0,2343085426|103,6167,84,71|101,48,82,69|109,100,105,77|105,110,69,73|110,83,92,78|105,79,86,73
```

### 2. 전달 과정

#### A. 클라이언트 측 (JavaScript)
```javascript
// TypingDNA JavaScript 라이브러리 사용
var tdna = new TypingDNA();

// 사용자가 "gemini" 텍스트를 타이핑
// 라이브러리가 키보드 이벤트를 자동으로 캡처

// 타이핑 패턴 생성
var pattern = tdna.getTypingPattern({
    type: 2,  // Extended 타입
    text: "gemini"
});

// 패턴을 서버로 전송
fetch('/api/typingdna', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        user_id: 'testuser123',
        text: 'gemini',
        tp: pattern
    })
});
```

#### B. 서버 측 (Python)
```python
# TypingDNA API로 전달
import requests
import base64

# 인증 헤더 생성
api_key = "3a07f4dae8484fb7f70d0d0613a3a3e4"
api_secret = "d97ae110a884c19f47318d54373e27d9"
auth_string = f"{api_key}:{api_secret}"
auth_encoded = base64.b64encode(auth_string.encode('utf-8')).decode('utf-8')

# API 요청
url = f"https://api.typingdna.com/auto/{user_id}"
headers = {
    "Authorization": f"Basic {auth_encoded}",
    "Content-Type": "application/x-www-form-urlencoded"
}
payload = {
    "tp": "0,3.2,0,1,6,3255507267,0,-1,-1,0,-1,-1,0,-1,-1,11,115,112,11,29,26,1,0,0,1,2,1,4210384742,1,1,0,0,0,1,2560,1440,2,1015,138,0,2343085426|103,6167,84,71|101,48,82,69|109,100,105,77|105,110,69,73|110,83,92,78|105,79,86,73"
}

response = requests.post(url, headers=headers, data=payload)
```

## 🔍 패턴의 특징

### 1. 개인화된 정보
- **타이핑 속도**: 3.2초 (평균)
- **키 간격**: 각 키마다 다른 간격
- **화면 해상도**: 2560x1440
- **마우스 위치**: (1015, 138)

### 2. 보안 특징
- **고유성**: 각 사용자마다 다른 패턴
- **복잡성**: 218자의 복잡한 문자열
- **시간 정보**: 밀리초 단위의 정확한 시간

### 3. 검증 가능성
- **재현성**: 동일한 텍스트에 대해 유사한 패턴 생성
- **변화성**: 타이핑할 때마다 약간의 차이 발생
- **정확도**: TypingDNA 알고리즘이 패턴을 분석하여 일치도 계산

## 📊 API 응답 분석

### 성공적인 응답
```json
{
  "message": "Pattern(s) enrolled. Not enough patterns for verification.",
  "message_code": 10,
  "action": "enroll",
  "enrollment": 1,
  "status": 200
}
```

### 응답 의미
- **enrollment: 1** - 패턴이 성공적으로 등록됨
- **action: "enroll"** - 등록 모드로 작동
- **message_code: 10** - 정상적인 등록 메시지

## 🎯 결론

### 타이핑 패턴 전달 방식 요약

1. **생성**: TypingDNA JavaScript 라이브러리가 사용자의 키보드 이벤트를 실시간으로 캡처
2. **구성**: 메타데이터 + 키보드 이벤트 시퀀스로 구성된 복잡한 문자열
3. **전송**: HTTP POST 요청으로 application/x-www-form-urlencoded 형식으로 전송
4. **인증**: Basic Authentication을 사용하여 API 키와 시크릿으로 인증
5. **처리**: TypingDNA 서버에서 패턴을 분석하고 등록/검증 수행

### 보안 및 개인정보 보호
- 패턴에는 개인을 식별할 수 있는 직접적인 정보는 포함되지 않음
- 타이핑 방식만을 기반으로 한 생체 인증
- 기존 비밀번호나 PIN과는 다른 차원의 보안 제공

이러한 방식으로 타이핑 패턴이 안전하고 효율적으로 전달되어 사용자 인증에 활용됩니다. 